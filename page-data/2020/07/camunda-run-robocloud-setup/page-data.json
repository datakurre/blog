{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020/07/camunda-run-robocloud-setup/","result":{"data":{"site":{"siteMetadata":{"title":"Asko Soukka","author":"Asko Soukka"}},"markdownRemark":{"id":"a2f3f11e-0271-5eaf-9aef-84b386886942","fields":{"slug":"/2020/07/camunda-run-robocloud-setup/"},"excerpt":"In my previous post I wrote an overview, how to implement a semi-automated business process involving both humans and robot with just Camunda BPM and Robocorp…","html":"<p><a href=\"/2020/07/camunda-robocloud/\">In my previous post</a> I wrote an overview, how to implement a semi-automated business process involving both humans and robot with just <a href=\"https://camunda.com/\">Camunda BPM</a> and <a href=\"https://hub.robocorp.com/\">Robocorp Robocloud RPA</a>. But how to really get started with Camunda BPM with Robocloud RPA?</p>\n<h2>Setting up Camunda Run</h2>\n<p>Camunda workflow engine comes in almost too many flavors to choose from. I would recommend starting with <a href=\"https://docs.camunda.org/manual/latest/user-guide/camunda-bpm-run/\">Camunda Run</a>. It is easier to configure than the default Tomcat-based distribution or Docker images. It is also based on <a href=\"https://docs.camunda.org/manual/latest/user-guide/spring-boot-integration/\">Camunda Spring Integration</a>, which is the next step when customizing Camunda for real use cases. Also, be aware that their cloud offering <a href=\"https://camunda.com/products/cloud/\">Camunda Cloud</a> is based on the next generation <a href=\"https://zeebe.io/\">Zeebe</a> engine. Camunda Cloud’s out of the box features don’t match the regular Camunda BPM suite yet.</p>\n<p>As long as you have Java runtime available, getting Camunda Run up and running should be almos trivial. Basically:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\" cm-s-solarized\"><code><span>$ curl -LO https://downloads.camunda.cloud/release/camunda-bpm/run/7.13/camunda-bpm-run-7.13.0.tar.gz\n$ tar xzvf camunda-bpm-run-7.13.0.tar.gz\n$ bash start.sh</span></code></pre>\n    </div>\n<p>Yet, to be able to trigger processes at Robocloud, a few extra plugins (for <code>http-connector</code>) have to be downloaded into <code>./configuration/userlib</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\" cm-s-solarized\"><code><span>$ curl -L https://repo1.maven.org/maven2/org/camunda/bpm/camunda-engine-plugin-connect/7.13.0/camunda-engine-plugin-connect-7.13.0.jar -o ./configuration/userlib/camunda-engine-plugin-connect-7.13.0.jar\n$ curl -L https://repo1.maven.org/maven2/org/camunda/connect/camunda-connect-core/1.4.0/camunda-connect-core-1.4.0.jar -o ./configuration/userlib/camunda-connect-core-1.4.0.jar\n$ curl -L https://repo1.maven.org/maven2/org/camunda/connect/camunda-connect-connectors-all/1.4.0/camunda-connect-connectors-all-1.4.0.jar -o ./configuration/userlib/camunda-connect-connectors-all-1.4.0.jar</span></code></pre>\n    </div>\n<p>Camunda Run ships with two default example configurations <code>./configuration/default.yml</code> and <code>./configuration/production.yml</code>. The default one is the active one. It configures user <code>demo</code> with password <code>demo</code> and leaves Camunda REST API completely unsecured</p>\n<p>But the default configuration is only good enough for local development and demonstrations. If you are about to make your Camunda instance public to make them accessible for Robocloud cloud workers, please, begin with</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\" cm-s-solarized\"><code><span>$ cp ./configuration/production.yml ./configuration/default.yml</span></code></pre>\n    </div>\n<p>before starting to customize the configuration more for your purposes.</p>\n<h2>Deploying the process model</h2>\n<p>To get anything done with Camunda BPM workflow engine, a BPMN workflow definition is required. The best available solution for this is to download and use the recommended <a href=\"https://camunda.com/download/modeler/\">Camunda Modeler</a>. It’s not only a very nice process modeling tool, but it also support deploying the models directly to Camunda. Oh, it even support starting processes from the modeler.</p>\n<p>Here’s my example model to download and experiment with:</p>\n<p><a href=\"/37ec4cac83d469b3d3676b7eb9583e7b/tweet-approval-process.bpmn\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.72972972972974%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABM5AAATOQGPwlYBAAABMElEQVQoz12RWQuDQAyE9///N18EEXwQ8caz3lft9nODpe1AQ5pMJtlRzfM8TROx7/txHJdlIR7Hse+71AUUh2H4/JWWquv6YZAkSVmWMKqqknbTNNTbtkU3z/M0TUWFFpGW0lqf58lCktcNyYnbtkmLhIEgCFDJsoxNKCp+aHddJ5Jsnm58X9sZMMmlnEbClJKr2PM0oAGJAYpEGe5vuK7LMLfAp654JwxtQIOTSFgFA9vWdSXKEwBdKvCpEFUURRjDQpQsy7Jtm4PjOMYeIqtI4LEDRcjkjuNwHbRruCiKMAyZR5jHYGNmwItqAyq+77NDoud5Yo2Sz/NnNd6ijQUcuRswz0NQFBfhXGdTRUP/AglxezEgQY4ohqEF5zIMD7lEvvs35l+IFoegJV8UzhuP23EwEkDJRAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Download Example BPMN\"\n        title=\"Download Example BPMN\"\n        src=\"/static/2d3143292199ab7cc4858b57016ca4c1/fcda8/tweet-approval-process.png\"\n        srcset=\"/static/2d3143292199ab7cc4858b57016ca4c1/12f09/tweet-approval-process.png 148w,\n/static/2d3143292199ab7cc4858b57016ca4c1/e4a3f/tweet-approval-process.png 295w,\n/static/2d3143292199ab7cc4858b57016ca4c1/fcda8/tweet-approval-process.png 590w,\n/static/2d3143292199ab7cc4858b57016ca4c1/efc66/tweet-approval-process.png 885w,\n/static/2d3143292199ab7cc4858b57016ca4c1/fd84e/tweet-approval-process.png 1056w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></a></p>\n<p>The deploy button is the second from the right on the toolbar:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3564041e96ce2aabaf2f450ce36bc1a3/4352a/camunda-modeler-deploy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABM5AAATOQGPwlYBAAABsklEQVQoz1VR2a6bMBTk//+mUt+qvvWhihQlJGE3YY+xYzCExUC4oRO4V21HFvjAGc+csWa5pmGfHWJFUZgmSRzHSZJEKIIAZfoPsjS9ZdnfdbtppmUapuF5nu/7QRCgHXzGmJSy/B+UUjRcVxBCXNfVLMsyDAME1I7jFEXRdV3btkqpvld914/j9PHxWpaFc27bNjTgC6dgo51XoIa4aZogy6rKGZV12faNGvttza8nxjkcDmh7D7VC03X9dDpBGV/1kw57gxrKQsB133fz843pOS3LCz273Q5uoxVw8bYNQfzABrbLSjqUWKmb1bkYJOsEFm3v9dhgZjAxHTRBBkvzVoB8uVz2+z3jXI0DlzyiUZiFeUHLphC1GGaFIaGMtMIvaNsLJyG24/GImRFVntM4iUUh7oILcUdUddMEYYgZv8jBNfA15LaRMQOcPB4PJMwE5TKXD6GerZq7aW6XRXHOLMveAovCKI3pJxmAK/CrqsKtjNOI+0JgEzAqWqgdGfxE+MRFWxwlNjF/6t80smITxxOpwLl4A8+CMZ7T24Xk33+zs5slcQipKIy9q/Pr/OMP8OxM6EABtAkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Diagram deployment screenshot\"\n        title=\"Diagram deployment screenshot\"\n        src=\"/static/3564041e96ce2aabaf2f450ce36bc1a3/fcda8/camunda-modeler-deploy.png\"\n        srcset=\"/static/3564041e96ce2aabaf2f450ce36bc1a3/12f09/camunda-modeler-deploy.png 148w,\n/static/3564041e96ce2aabaf2f450ce36bc1a3/e4a3f/camunda-modeler-deploy.png 295w,\n/static/3564041e96ce2aabaf2f450ce36bc1a3/fcda8/camunda-modeler-deploy.png 590w,\n/static/3564041e96ce2aabaf2f450ce36bc1a3/efc66/camunda-modeler-deploy.png 885w,\n/static/3564041e96ce2aabaf2f450ce36bc1a3/c83ae/camunda-modeler-deploy.png 1180w,\n/static/3564041e96ce2aabaf2f450ce36bc1a3/4352a/camunda-modeler-deploy.png 1364w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Keeping secrets with Camunda</h2>\n<p>The most interesting part in my example BPMN process definition related to Robocloud is probably the service task activity “<code>Schedule Robot to tweet</code>”. It uses Camunda HTTP connector to call Robocloud HTTP API, which again triggers the configured process with accompanying payload. Obviously, the definition should contain neither hardcoded process trigger API URL nor its secret.</p>\n<p>One possible solution for keeping secrets with Camunda is to pass those secrets as environment variables when starting the engine:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\" cm-s-solarized\"><code><span>ROBOCLOUD_PROCESS_URL=\"https://api.eu1.robocloud.eu/.../runs\" ROBOCLOUD_PROCESS_SECRET=\"secret\" bash start.sh</span></code></pre>\n    </div>\n<p>Those secrets could then be loaded from environment variables into activity variables available only within the service task. This could be done in Camunda Modeler by defining “<code>Input Parameter</code>” with type  “<code>Script</code>” for the service task activity. The script would then rely on Camunda’s JavaScript engine (Nashorn) ability to call Java API for reading the environment variables with something like <code>(java.lang.System).getenv('ENV_VAR_NAME')</code>:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/48f842895a0d3c2bbcd6c1730e6f12ef/4352a/camunda-connector-secret.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABM5AAATOQGPwlYBAAABb0lEQVQoz3VS2W7DIBDk/7+qf9BKSdWoaZrWqQ0+MDaHuYzdiYnf2hFCHDszyy6kFTXrSj40xmjvvXMuz9ZO8xznDSmlZcG0rbdtXhNtNAbOcLD+hWVZvA+i52ocUoSu8l4n74J3ZBxHzjkEABiaHVJKrbW1drvS54K+frLvRl2YvNTqnSrKRwJm27ZKKYQgdJom0LDu+55SiivKmNHqysTzV3/8GY/UvjXhwGLZSYII8PGAaQP4WQUzYwxX0OU995NKQa+LX9fHsEYSOCBbIQSCQgiol7UOKpDrug6Z4xAxyN06H+KcR5yTmSypqgrmp9OpruuiKLCrKnY+f9xuN9jitizLGIMQPbRyXTKQHcmGMd67Ap+cuZQKhUQ0ZpTAeYcnQH0YBr0DRAIxNCM3Ex3OZACKIIAcQ8Q5UkDxYKhzY9AArUn+FRk5hbDj/rQ5aStf6qemrXnHoQVzseHunAnr/5iXeB0OsH98qx0w+wUe9HVON/rWpwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Activity input parameters dialog screenshot\"\n        title=\"Activity input parameters dialog screenshot\"\n        src=\"/static/48f842895a0d3c2bbcd6c1730e6f12ef/fcda8/camunda-connector-secret.png\"\n        srcset=\"/static/48f842895a0d3c2bbcd6c1730e6f12ef/12f09/camunda-connector-secret.png 148w,\n/static/48f842895a0d3c2bbcd6c1730e6f12ef/e4a3f/camunda-connector-secret.png 295w,\n/static/48f842895a0d3c2bbcd6c1730e6f12ef/fcda8/camunda-connector-secret.png 590w,\n/static/48f842895a0d3c2bbcd6c1730e6f12ef/efc66/camunda-connector-secret.png 885w,\n/static/48f842895a0d3c2bbcd6c1730e6f12ef/c83ae/camunda-connector-secret.png 1180w,\n/static/48f842895a0d3c2bbcd6c1730e6f12ef/4352a/camunda-connector-secret.png 1364w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Finally, those variables could then be used in parameter values using Camunda’s “<code>${variable}</code>”-like string interpolation syntax:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1c8879f46b02db36ea3b8afce99f6894/4352a/camunda-service-task.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABM5AAATOQGPwlYBAAABSElEQVQoz3WSSY6DMBBFff9b9Q160YtIYZFBEMyMwdhgQvrhSqIsur+QhWv49avKqmx1XqV1V1g7zvPsvZfTuWldwxpx38FlCS+LQI125Fvve8TjL2zbNs9L13Vm6McPWGtV3/d1Xcd/S0H7gjGGCOecxGmtCVuWxUegrmkahaksy2EYiCB0mibS+Md3u91wcdpxT9aFju08UVWVwkc+DUwRWIWFM89zXHC1bZskyfl8poaJQC9sigrw4cYRVc3OeViggxvNGInBgtT3qEIIe+Usyyh+OBxgulwu3LIsPx6T6/VKWbxpmr5bDR/Ye5aCXOCjjig3TLbv4eZEpJ99URSoEwoCngOjN5Yhy8QkyQBGeiYZXhIg2rcVIZ3vsmXuApGwvBCfxH105lt/MWpy8IoEvDSlJOHxP9YtnMxP09Z1VaNIVisP4Re5F3VuP+RnuAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Service task HTTP connector configuration screenshot\"\n        title=\"Service task HTTP connector configuration screenshot\"\n        src=\"/static/1c8879f46b02db36ea3b8afce99f6894/fcda8/camunda-service-task.png\"\n        srcset=\"/static/1c8879f46b02db36ea3b8afce99f6894/12f09/camunda-service-task.png 148w,\n/static/1c8879f46b02db36ea3b8afce99f6894/e4a3f/camunda-service-task.png 295w,\n/static/1c8879f46b02db36ea3b8afce99f6894/fcda8/camunda-service-task.png 590w,\n/static/1c8879f46b02db36ea3b8afce99f6894/efc66/camunda-service-task.png 885w,\n/static/1c8879f46b02db36ea3b8afce99f6894/c83ae/camunda-service-task.png 1180w,\n/static/1c8879f46b02db36ea3b8afce99f6894/4352a/camunda-service-task.png 1364w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Calling home from Robocloud</h2>\n<p>Usually it is not enough that Camunda can invoke processes at Robocloud, but also Robocloud must be able to send messages back to Camunda processes. Actually, in my example, the Camunda process even gets started by receiving a message from Robocloud run process.</p>\n<p>Camunda, of course, has a <a href=\"https://docs.camunda.org/manual/latest/reference/rest/\">complete REST API</a> for automating its features. Unsurprisingy, there also is a dedicated end point for starting new process instances. Yet, the most flexible way to interact with processes are <strong>messages</strong>.</p>\n<p>In my example process, it made sense to model the start of the approval process with a message receiving event “<code>Tweet proposal</code>”:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5d10247a659278750ad11c8e2aba2f29/4352a/camunda-start-event.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABM5AAATOQGPwlYBAAABMElEQVQoz3WSOXbDMBBDef9L5Qgp0rhKEUVPpFZql6jF/iKe/VwkKMbSEMCAI5uicbZMK5+P47Cu67IsqvM8708cx3GeJzU+v9q7GcYBiHH/C8hCCHnp8iKfI9YnDMo8Z+zY933XdVSOpylaDoM6bds6Z+u6piMC0aZpMk3TFEXBCzze8QsR2FGhcoq4LEsIBNy2TQQkBj9rLZb4SQNwoaM4zrk0TamMUZApglPDDwdQuZ6P0LY4087k/hNBCkUQDNMQZJlNkt/b7ZZlGXPYQpIkTUQZgQV2W4RiXwtjIF3O4JGCnWumKretqsq3lwvzcYGzPHGJdUMe9MF087jza38k7X2v8PSXNxhp9N8QEL+y7ds+h/HTfvjO6yO9aJdYpPv/2M/t23+tYTn2I7wB8QOOfne/dcWSkwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Start event configuration screenshot\"\n        title=\"Start event configuration screenshot\"\n        src=\"/static/5d10247a659278750ad11c8e2aba2f29/fcda8/camunda-start-event.png\"\n        srcset=\"/static/5d10247a659278750ad11c8e2aba2f29/12f09/camunda-start-event.png 148w,\n/static/5d10247a659278750ad11c8e2aba2f29/e4a3f/camunda-start-event.png 295w,\n/static/5d10247a659278750ad11c8e2aba2f29/fcda8/camunda-start-event.png 590w,\n/static/5d10247a659278750ad11c8e2aba2f29/efc66/camunda-start-event.png 885w,\n/static/5d10247a659278750ad11c8e2aba2f29/c83ae/camunda-start-event.png 1180w,\n/static/5d10247a659278750ad11c8e2aba2f29/4352a/camunda-start-event.png 1364w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Camunda messages are not that complex:</p>\n<ul>\n<li>\n<p>A minimal message only has the <strong>message name</strong>, and the message would be sent to all processes waiting for messages with matching name.</p>\n</li>\n<li>\n<p>In addition, message could have any amount of <strong>correlated process variables</strong> to only affect processes with matching variable values.</p>\n</li>\n<li>\n<p>Finally, message could have payload of additional <strong>process variables</strong> to inject into the process instance.</p>\n</li>\n</ul>\n<p>The other message receiving event in my process, “<code>Robot acknowledges</code>”, expects a correlated process variable, the tweeted message. It allows Camunda to pass message to the correct process instance. Unfortunately, this requirement is not visible in th e model, so it remains possible to acknowledge more than expected by accident:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a7425d5327a48bfa2850e6bfb650e3b4/4352a/camunda-receive-event.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABM5AAATOQGPwlYBAAABLUlEQVQoz2WRaW6FMAyEc/9r9Qbt/7IIsYZ9C0ugH7GgqB09WWHsGU/ylK6zrIyrrhjHYV0XINWY2dqdH7DWHgfFuvP+QA3D0Pe9WYwMPY1t2+QAiWFR5rrU82ymaTLGLA6qbdu6rqFmB+lB4khbeCzyPGdMNskMVcGWZfmY0WOamiRJlmVRFGF0nmdVVRwkzuqARBVFgX4cR+OAUlzhm6YRHjJNU601+q7rJgdaikYcx0TqHdgAKzkRk5NtjAZBEIahduhuKLIhZg81d4CN48T3feY8zyMhsbkaF8HuueAVWx6WJyXCcIMhEcvocVrEJMfXvKDeH3JhKtskmLw2m7kXXpyXG5f4eIGhP59g2c1n8cEfjEDcfzfLu5//4MSXfj+27+bLLMTZ1hcQ/wCGuHhP6T89LwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Message receive event configuration screenshot\"\n        title=\"Message receive event configuration screenshot\"\n        src=\"/static/a7425d5327a48bfa2850e6bfb650e3b4/fcda8/camunda-receive-event.png\"\n        srcset=\"/static/a7425d5327a48bfa2850e6bfb650e3b4/12f09/camunda-receive-event.png 148w,\n/static/a7425d5327a48bfa2850e6bfb650e3b4/e4a3f/camunda-receive-event.png 295w,\n/static/a7425d5327a48bfa2850e6bfb650e3b4/fcda8/camunda-receive-event.png 590w,\n/static/a7425d5327a48bfa2850e6bfb650e3b4/efc66/camunda-receive-event.png 885w,\n/static/a7425d5327a48bfa2850e6bfb650e3b4/c83ae/camunda-receive-event.png 1180w,\n/static/a7425d5327a48bfa2850e6bfb650e3b4/4352a/camunda-receive-event.png 1364w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Then the actual call from Robocloud to Camunda. It is simply a HTTP POST, for example, using Robocorp’s open source <a href=\"https://rpaframework.org/libraries/http/\">RPA Framework umbrella library for Robot Framewokr Python</a>. Yet, one should not simply do the call without a little bit more configuration and secret management…</p>\n<h2>Keeping secrets at Robocloud</h2>\n<p>I implemented a simple reusable Robot Framework activity to call Camunda from Robocoud. My activity required only the default libraries and features available for Robocloud worker. The core functionality of my activity is in this keyword “<code>Post message to Camunda</code>”:</p>\n<div class=\"gatsby-highlight\" data-language=\"robotframework\">\n      <pre class=\" cm-s-solarized\"><code><span class=\"cm-header\">*** Keywords ***</span><span>\n</span><span class=\"cm-def\">Post</span><span> </span><span class=\"cm-def\">message</span><span> </span><span class=\"cm-def\">to</span><span> </span><span class=\"cm-def\">Camunda</span><span>\n</span><span>    </span><span class=\"cm-meta\">[Arguments]</span><span>  </span><span class=\"cm-variable-2\">${message</span><span class=\"cm-variable-2\">}</span><span>\n</span><span>    </span><span class=\"cm-keyword\">Register</span><span> </span><span class=\"cm-keyword\">Protected</span><span> </span><span class=\"cm-keyword\">Keywords</span><span>  </span><span class=\"cm-string\">Create</span><span> </span><span class=\"cm-string\">dictionary</span><span>\n</span><span>    </span><span class=\"cm-keyword\">Register</span><span> </span><span class=\"cm-keyword\">Protected</span><span> </span><span class=\"cm-keyword\">Keywords</span><span>  </span><span class=\"cm-string\">Post</span><span> </span><span class=\"cm-string\">request</span><span>\n</span><span>    </span><span class=\"cm-variable-2\">${secrets}</span><span class=\"cm-operator\">=</span><span>  </span><span class=\"cm-keyword\">Get</span><span> </span><span class=\"cm-keyword\">secret</span><span>  </span><span class=\"cm-variable-2\">${SECRET_NAME</span><span class=\"cm-variable-2\">}</span><span>\n</span><span>    </span><span class=\"cm-variable-2\">${headers}</span><span class=\"cm-operator\">=</span><span>  </span><span class=\"cm-keyword\">Create</span><span> </span><span class=\"cm-keyword\">dictionary</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">Accept</span><span class=\"cm-operator\">=</span><span class=\"cm-string\">application/json</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">Content-Type</span><span class=\"cm-operator\">=</span><span class=\"cm-string\">application/json</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">Authorization</span><span class=\"cm-operator\">=</span><span class=\"cm-variable-2\">${secrets}</span><span class=\"cm-bracket\">[</span><span class=\"cm-string\">CAMUNDA_AUTHORIZATION</span><span class=\"cm-bracket\">]</span><span>\n</span><span>    </span><span class=\"cm-variable-2\">${messageVariable}</span><span class=\"cm-operator\">=</span><span>  </span><span class=\"cm-keyword\">Create</span><span> </span><span class=\"cm-keyword\">dictionary</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">value</span><span class=\"cm-operator\">=</span><span class=\"cm-variable-2\">${message</span><span class=\"cm-variable-2\">}</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">type</span><span class=\"cm-operator\">=</span><span class=\"cm-string\">string</span><span>\n</span><span>    </span><span class=\"cm-variable-2\">${processVariables}</span><span class=\"cm-operator\">=</span><span>  </span><span class=\"cm-keyword\">Create</span><span> </span><span class=\"cm-keyword\">dictionary</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">message</span><span class=\"cm-operator\">=</span><span class=\"cm-variable-2\">${messageVariable</span><span class=\"cm-variable-2\">}</span><span>\n</span><span>    </span><span class=\"cm-variable-2\">${data}</span><span class=\"cm-operator\">=</span><span>  </span><span class=\"cm-keyword\">Create</span><span> </span><span class=\"cm-keyword\">dictionary</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">messageName</span><span class=\"cm-operator\">=</span><span class=\"cm-variable-2\">${CAMUNDA_MESSAGE_NAME</span><span class=\"cm-variable-2\">}</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">correlationKeys</span><span class=\"cm-operator\">=</span><span class=\"cm-variable-2\">${processVariables</span><span class=\"cm-variable-2\">}</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">processVariables</span><span class=\"cm-operator\">=</span><span class=\"cm-variable-2\">${processVariables</span><span class=\"cm-variable-2\">}</span><span>\n</span><span>    </span><span class=\"cm-keyword\">Create</span><span> </span><span class=\"cm-keyword\">session</span><span>  </span><span class=\"cm-string\">default</span><span>  </span><span class=\"cm-variable-2\">${CAMUNDA_REST_URL</span><span class=\"cm-variable-2\">}</span><span>\n</span><span>    </span><span class=\"cm-keyword\">Post</span><span> </span><span class=\"cm-keyword\">request</span><span>  </span><span class=\"cm-string\">default</span><span>  </span><span class=\"cm-string\">/message</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">json</span><span class=\"cm-operator\">=</span><span class=\"cm-variable-2\">${data</span><span class=\"cm-variable-2\">}</span><span>\n</span><span>    </span><span class=\"cm-bracket\">...</span><span>  </span><span class=\"cm-attribute\">headers</span><span class=\"cm-operator\">=</span><span class=\"cm-variable-2\">${headers</span><span class=\"cm-variable-2\">}</span></code></pre>\n    </div>\n<p>No hard-coded values in that keyword. Instead, it keyword requires both public and secret configuration parameters to be able to post a message with the passed “<code>${message}</code>” argument.</p>\n<p>Public parameters could be configured as suite level variables with values from environment variables. For example, my activity requires to know the root URL of Camunda REST API “<code>${CAMUNDA_REST_URL}</code>” and name of the message to be posted “<code>${CAMUNDA_MESSAGE_NAME}</code>”:</p>\n<div class=\"gatsby-highlight\" data-language=\"robotframework\">\n      <pre class=\" cm-s-solarized\"><code><span class=\"cm-header\">*** Variables ***</span><span>\n</span><span class=\"cm-variable-2\">${CAMUNDA_REST_URL}</span><span>  </span><span class=\"cm-variable-2\">%{CAMUNDA_REST_URL</span><span class=\"cm-variable-2\">}</span><span>\n</span><span class=\"cm-variable-2\">${CAMUNDA_MESSAGE_NAME}</span><span>  </span><span class=\"cm-variable-2\">%{CAMUNDA_MESSAGE_NAME</span><span class=\"cm-variable-2\">}</span><span>\n</span><span class=\"cm-variable-2\">${SECRET_NAME}</span><span>  </span><span class=\"cm-variable-2\">%{SECRET_NAME</span><span class=\"cm-variable-2\">}</span></code></pre>\n    </div>\n<p>Robocloud Hub has a dedicated tutorial on <a href=\"https://hub.robocorp.com/knowledge-base/articles/configuring-activities-using-environment-variables/\">Using environment variables to configure your activities</a>.</p>\n<p>The last required variable “<code>${SECRET_NAME}</code>” is for reading a dictionary of secrets from Robocloud secrets vault. Particulary “<code>${secrets}[CAMUNDA_AUTHORIZATION]</code>” to be used as Authorization-header to authenticate Camunda. <a href=\"https://hub.robocorp.com/knowledge-base/articles/vault/\">Using a vault for secrets</a> is the recommended for managing secrets. But just using the vault for secrets is not enough…</p>\n<p>Robot Framework comes with excellent step by step execution logs. Those comprehensive logs are a big reason, why Robot Framework works so well for RPA. Unfortunately, Robot Framework does not magically know what should be kept secret and what should could remain public for debugging purposes. Everything is public by default.</p>\n<p>Preventing secrets leaking into logs must be done manually by registering keywords using secrets before their usage with “<code>Register Protected Keywords”</code>, as shown in myt example “<code>Post message to Camunda</code>”-keyword. An example for this is shown in my example keyword. This and and all the other keyword are part of <a href=\"https://rpaframework.org/\">RPA Framework -library</a> and can be used by importing their respective libraries:</p>\n<div class=\"gatsby-highlight\" data-language=\"robotframework\">\n      <pre class=\" cm-s-solarized\"><code><span class=\"cm-header\">*** Settings ***</span><span>\n</span><span class=\"cm-meta\">Library</span><span>  </span><span class=\"cm-string\">RPA.HTTP</span><span>\n</span><span class=\"cm-meta\">Library</span><span>  </span><span class=\"cm-string\">RPA.Robocloud.Secrets</span><span>\n</span><span class=\"cm-meta\">Library</span><span>  </span><span class=\"cm-string\">RPA.RobotLogListener</span></code></pre>\n    </div>\n<p>All the above might look quite complex for a such simple and silly task as my example process was. Yet, these principles should allow any integration of Robocloud robots with real business processes – even those not yet completely automated and still requiring human interaction or supervision.</p>","frontmatter":{"title":"Setting up Camunda Run and connecting with Robocloud","tags":["Open Source","RPA","Robocloud","Camunda"],"date":"July 12, 2020","published":"2020-07-12 12:00:00"}}},"pageContext":{"slug":"/2020/07/camunda-run-robocloud-setup/","previous":{"fields":{"slug":"/2020/07/camunda-robocloud/"},"frontmatter":{"title":"Connecting the dots – Automated business process with Robocloud and Camunda BPM"}},"next":{"fields":{"slug":"/2021/01/camunda-cockpit-history-plugin/"},"frontmatter":{"title":"Open source “history plugin” for Camunda Cockpit"}}}},"staticQueryHashes":["63159454"],"slicesMap":{}}