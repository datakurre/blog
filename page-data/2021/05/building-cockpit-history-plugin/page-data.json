{"componentChunkName":"component---src-templates-blog-post-js","path":"/2021/05/building-cockpit-history-plugin/","result":{"data":{"site":{"siteMetadata":{"title":"Asko Soukka","author":"Asko Soukka"}},"markdownRemark":{"id":"3f1224ea-8dce-5260-bcbc-097a73a4422f","fields":{"slug":"/2021/05/building-cockpit-history-plugin/"},"excerpt":"For the last few months, I’ve been steadily developing an open source “history plugin” for Camunda Community Edition Cockpit. Obviously a very basic one, but…","html":"<p>For the last few months, I’ve been steadily developing <a href=\"https://github.com/datakurre/camunda-cockpit-plugins/\">an open source “history plugin” for Camunda Community Edition Cockpit</a>. Obviously a very basic one, but one that’s growing and learning Camunda with me. This is a small writeup on how it came to be.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/91b19e04d4fedbdc8a4f3bc2f977635d/cab0a/history-plugin-01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABv0lEQVQoz2VSi46jMAzk/3/vpJNW6krdPQoNrxACeVEy50lptaezZCwSezwep/r+qtHULVTbYR4nzMMII9HOM8K6ITqHsD1jcl48lMizcr65krcaA6tnVHelYNcVPgQcOSMD7/9NQByLY8RiF0xmRK+VxKmcRXHvPWJKoO2PByp1v8NaiySXmYDietIwi0HT1ajbbwF3sH7Gtb3gcv3A789fpYGThn3fYz8Bj+NA1XUdjNBlpxfgLOOyYJORtNFQusFgyGzANIksZi53BGRtkGnegEpGXmXEJF0IRmMTNjgeB9KeUKsvXJtPXP58wPkN1OUh4xGAdf8AkjJHpmY/GRKQiSFEYbJhWRaMeoCampJvlucU67aWXBprKxaxSzp1oBGQDF5JP200PRp1w03VUEOL5n5DlKY0YlT8xHNj9CDd2NGVDf/vxggrK6xk+5s8mVWeDDFIQGuNSkCyHGRGETivZskxhCyin+7e93TvXZbxy5lon2X8LFOedz5Xr3HpWjbIN0imi2yPy5rksRaNT03JkossbEWatm3LxlOKwtw+NXw5nwRB9rSXJIJMsynFb0nOPEbmjuNYcjcfigR/AcrKUhN9JH56AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"The plugin includes a custom &quot;history route&quot; for browsing completed processes.\"\n        title=\"The plugin includes a custom &quot;history route&quot; for browsing completed processes.\"\n        src=\"/static/91b19e04d4fedbdc8a4f3bc2f977635d/fcda8/history-plugin-01.png\"\n        srcset=\"/static/91b19e04d4fedbdc8a4f3bc2f977635d/12f09/history-plugin-01.png 148w,\n/static/91b19e04d4fedbdc8a4f3bc2f977635d/e4a3f/history-plugin-01.png 295w,\n/static/91b19e04d4fedbdc8a4f3bc2f977635d/fcda8/history-plugin-01.png 590w,\n/static/91b19e04d4fedbdc8a4f3bc2f977635d/efc66/history-plugin-01.png 885w,\n/static/91b19e04d4fedbdc8a4f3bc2f977635d/c83ae/history-plugin-01.png 1180w,\n/static/91b19e04d4fedbdc8a4f3bc2f977635d/cab0a/history-plugin-01.png 3410w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><em>The plugin includes a custom “history route” for browsing completed processes.</em></p>\n<p>Camunda BPM 7.14 was the first Camunda Platform release with <a href=\"https://docs.camunda.org/manual/latest/webapps/cockpit/extend/plugins/\">the new frontend plugin system</a>. Around the time of its release, in October 2020, I was still polishing up our first real Camunda-based project production ready. Because the project included its own simple user interface, I was not too worried about the limitations of the Community Edition of Camunda Cockpit. Besides, we had already implemented some process history visualization on our application with <a href=\"https://bpmn.io/toolkit/bpmn-js/\">bpmn-js</a> and <a href=\"https://docs.camunda.org/manual/latest/reference/rest/\">Camunda REST API</a>. Still, I knew that new use cases with new requirements would come soon…</p>\n<p>In late November, a Camunda tutorial on <a href=\"https://www.youtube.com/watch?v=BwsoozZRAqo\">How to Build a Camunda Cockpit Plugin</a> release at Youtube coincided with our team’s “hack day” at work. If that was not a sign, I don’t know what is. I had some prior experience on Camunda history REST API and bpmn-js already, and I was able to complete a functional first version already on that same day. That was a pleasant experience!</p>\n<p><a href=\"https://github.com/datakurre/camunda-cockpit-plugins/commit/1acea4c95340b0f42e433c1e13d1497400e45ac4\">The first commit</a> to the public GitHub repository came soon after. The first version had no frameworks, no architecture – just plain JavaScript, and me copying and pasting code around like there was no tomorrow. After all, technically it was already four separate plugins: two tab plugins and two diagram overlay plugins. All having at least some overlapping code.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8575e64d6ab39d46ed811766dfe0d89e/cab0a/history-plugin-02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABrElEQVQoz1VT2ZKjMAzk/z9x9mU3DJe5wTZHEvd0K6F2QpVKts5uWWTff3PUZY26cmhrh6Ft0dUNRmo/zYjrirAsiMuKzXvsPpjWXT6zr95iJVldlJjnGSFGPJ5Pk2maEHnvh8Hs27bBh4DGORRFgXEcse07Iu2S836Hvv04kDnXwPsVJy9PFkuUvu9NyrJER70z+fF4IM9zfH39we12syYDG07jhPt5WkHZsq4fMa8RPu5WUIkt6R5scGfnhXSbpjFUQq7iEvklYiKtT/FZQRQL53CwiwrK2HXdC21KFqx7WVaoqsrsvz8B+CjoXIsQ1OVVUCIqgv8byba9kKn4NRLNfuXDfBTshwndMJN2MEQS0ZPzQ4hE+ruq8e+WW2GNwvGhLmYCll0zOc/jPZ+Xju/X1XnTmSJELQud5/9Goiw5OTLFZjwkzi/RmZiQSDeRQiIVO3MtUvQ+dc4lT30cu8WxocVcsfIRQFJBq65uQiAqmknQ3pGSbLo7vnz/XiHNWLPTNijOa9FjQOTZKIuakrQiWg01EGUlKlg+zVX+Ky6+R6D8wJiVf1CMG34AJGdRHG6M9i8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"The first version, written in plain JavaScript, included historical tokens on diagrams and minimal activity audit log for running processes.\"\n        title=\"The first version, written in plain JavaScript, included historical tokens on diagrams and minimal activity audit log for running processes.\"\n        src=\"/static/8575e64d6ab39d46ed811766dfe0d89e/fcda8/history-plugin-02.png\"\n        srcset=\"/static/8575e64d6ab39d46ed811766dfe0d89e/12f09/history-plugin-02.png 148w,\n/static/8575e64d6ab39d46ed811766dfe0d89e/e4a3f/history-plugin-02.png 295w,\n/static/8575e64d6ab39d46ed811766dfe0d89e/fcda8/history-plugin-02.png 590w,\n/static/8575e64d6ab39d46ed811766dfe0d89e/efc66/history-plugin-02.png 885w,\n/static/8575e64d6ab39d46ed811766dfe0d89e/c83ae/history-plugin-02.png 1180w,\n/static/8575e64d6ab39d46ed811766dfe0d89e/cab0a/history-plugin-02.png 3410w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><em>The first version, written in plain JavaScript, included historical tokens on diagrams and minimal activity audit log for running processes.</em></p>\n<p>But those first versions were only able to augment views for running processes. They were completely missing the main thing: Historical route and view for completed processes. And there my learning curve and progress went Z-shaped.</p>\n<p>So far, it had been enough to render gray tokens and a table: little HTML and some CSS. Simply copying the HTML structure and CSS class names from the default views got me far enough. But for the history view I had to provide everything from draggable panels to BPMN rendering myself. Of course, that was also the opportunity. I had my MVP, now I could do it right.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f7041a0f698127da71aabc22815a3767/cb88c/history-plugin-03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABcElEQVQoz42SfW+CMBDG+czbvo3ZB1qyf102N11AeXGCgKUtpdBndx04Y9TY5MlROJ77Xa+Byr5QhXM0mw+I6B0mW8HtIgzb0KvPItg0QpeuYZIN2iSGCEMUn0tUyzW+X+f4epnj5y2FThWCJNthm++hjEUlFGTboSFxlOZfalLH0VCOhoXD7HmGx6cHLFYLWGcR7PcF4niDJI5RVSU6SjaUbEyLVuub0kqjEQ2EEJBN4/8NGnooisJv+r6HUgqHSkIcFO0trLX+/TAMl+UcnBugqaOuHxBUdY2aKvAaHFASsWwktGZKg7Ztvemt5cjUdj1FMKEkbEnVyJAcd1kCKWnv/ggmOudJrmsYFfAPlkgcRS4hqEBN1B0dPtOx2URxSdM3rTr0BBSc42+TtT9HbnMSF71lOvpyBoLzajz1NE1p4pWnvKddlmLCfiQ8Nczz3E+dDbl1Hs5pa1fPcCx8NJxWlmUoy/J4Lfjq3ENpx5xfv1JYa+zMlocAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Converting plain JavaScript prototype into ReactJS application involves choosing the right packages from more than 156890 options.\"\n        title=\"Converting plain JavaScript prototype into ReactJS application involves choosing the right packages from more than 156890 options.\"\n        src=\"/static/f7041a0f698127da71aabc22815a3767/fcda8/history-plugin-03.png\"\n        srcset=\"/static/f7041a0f698127da71aabc22815a3767/12f09/history-plugin-03.png 148w,\n/static/f7041a0f698127da71aabc22815a3767/e4a3f/history-plugin-03.png 295w,\n/static/f7041a0f698127da71aabc22815a3767/fcda8/history-plugin-03.png 590w,\n/static/f7041a0f698127da71aabc22815a3767/efc66/history-plugin-03.png 885w,\n/static/f7041a0f698127da71aabc22815a3767/c83ae/history-plugin-03.png 1180w,\n/static/f7041a0f698127da71aabc22815a3767/cb88c/history-plugin-03.png 2728w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><em>Converting plain JavaScript prototype into ReactJS application involves choosing the right packages from more than 156890 options.</em></p>\n<p>I started my rewrite by looking into re-using the bundled user interface components in Camunda. I soon found out that there really is a component library called <a href=\"https://github.com/camunda/camunda-bpm-platform/tree/master/webapps/camunda-commons-ui\">camunda-commons-ui</a>, but with big warning letters about it being subject to change at any time. I was more into <a href=\"https://reactjs.org/\">ReactJS</a> and <a href=\"https://www.typescriptlang.org/\">TypeScript</a> anyway, so I hide my experiments on calling those AngularJS widgets from my plugins, and went to crawl npm registry for <a href=\"https://github.com/datakurre/camunda-cockpit-plugins/blob/7e2d5ae4004da25865365f91e64af46ff4db01a8/package.json#L18\">components for the replacement widgets</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bac4f79dc4d161d7245f8fb29080fe4a/58260/history-plugin-04.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3UlEQVQozz1S246dMBDj//+uD5WqVtX2bBcIl0DIjcs5imtnlyINIcTj8XjSfDw+YDoD048Y+wHLNMGOI+wwIqyuZB+wznP58/YofWvQd6ZMZoCbLbFzxSfvkTaPbVnQmLbDxk3adzi/YbAGG9frutD1fXn/+w63uaLvECPyfpRlXWGmnnhXcW3b4vF4wIeAZhgHJAFzwsIKgT+nxXD1mKnMWovNucKkEoljlJWEKUXiBngWn6WUucdxoJntCh93HgSCEvS44ND2HUhWtKeK0kshizHKjQvJwwymkul5vV5o2q6rUvddpL62cJ5XXXPOZRgGWrJVwlg7yUW48zqJOysusbuRviuacaSpOVdCKZDs/LVXexNNZ/taPwn3vRw8u0T2vPB8PqtdskbFm3lxsM5jtQssk1XdOdqwbVUZo6pim0XJSQodz5a1FpZKDVXFqod6neeBSF82koUQEWLiPsP6VIYfvxBJvB9Hqe2RWMmySbjMPA6PIlwlbU4aLtO/vBG4EMyIZfa5mG/fETnlfOz/CaVcmGm25WvqNZTfCKS4PVQbqqxYw475529kAqXw069cbYg8d7wZUqV7qetTFd6E98Q0+juu64mDE1ewYFUoixQiv3Mlghee/0/8A4GtS4QjtEoZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Spot the differences and missing features between official view using AngularJS components (on the left), and the custom &quot;history view&quot; re-implementing everything with ReactJS components (on the right).\"\n        title=\"Spot the differences and missing features between official view using AngularJS components (on the left), and the custom &quot;history view&quot; re-implementing everything with ReactJS components (on the right).\"\n        src=\"/static/bac4f79dc4d161d7245f8fb29080fe4a/fcda8/history-plugin-04.png\"\n        srcset=\"/static/bac4f79dc4d161d7245f8fb29080fe4a/12f09/history-plugin-04.png 148w,\n/static/bac4f79dc4d161d7245f8fb29080fe4a/e4a3f/history-plugin-04.png 295w,\n/static/bac4f79dc4d161d7245f8fb29080fe4a/fcda8/history-plugin-04.png 590w,\n/static/bac4f79dc4d161d7245f8fb29080fe4a/efc66/history-plugin-04.png 885w,\n/static/bac4f79dc4d161d7245f8fb29080fe4a/c83ae/history-plugin-04.png 1180w,\n/static/bac4f79dc4d161d7245f8fb29080fe4a/58260/history-plugin-04.png 3404w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><em>Spot the differences and missing features between official view using AngularJS components (on the left), and the custom “history view” re-implementing everything with ReactJS components (on the right).</em></p>\n<p>Next up was the building and bundling challenge. One does not simply declare dozens of ReactJS components and SVG icons as dependencies for a Cockpit plugin and expect them to work by magic. I decided to bundle my plugins, and their dependencies into easily distributable standalone plugin scripts – not only including the compiled JavaScript code, but also the required CSS styles. For bundling, tried both <a href=\"https://webpack.js.org/\">Webpack</a>, which I was familiar before, and <a href=\"https://rollupjs.org/\">Rollup</a>, which was <a href=\"https://camunda.com/blog/2020/08/all-new-frontend-plugin-system-for-cockpit-starting-with-camunda-bpm-7-14/\">the featured bundler option on Camunda blog</a>. Rollup was the winner in this contest, and hopefully <a href=\"https://github.com/datakurre/camunda-cockpit-plugins/blob/7e2d5ae4004da25865365f91e64af46ff4db01a8/rollup.config.js\">the Rollup configuration for my plugin</a> will help others with similar requirements.</p>\n<p>Once the rewrite was done, it has been easy to return to the project every now and then, to implement features I’ve considered helpful for my use of Camunda. Maybe the most interesting feature so far has, been adding the curved green highlight for the executed path, as inspired by Nico Rehwaldt’s <a href=\"https://github.com/nikku/camunda-playground\">camunda-playground</a>. The current implementation is not flawless, but for me it has been good enough for giving a visual overview of the execution, with just a glance.</p>\n<p><img src=\"/5d4fc7cc3cab8031e73848697657ee55/history-plugin-05.gif\" alt=\"The plugin can highlight the executed path in the process. At least in quite many of the cases…\"></p>\n<p><em>The plugin can highlight the executed path in the process. At least in quite many of the cases…</em></p>\n<p>That’s the story of the open source “history plugin” for Camunda Cockpit so far. The plugin is <a href=\"https://github.com/datakurre/camunda-cockpit-plugins/\">publicly available at GitHub</a>, and it supports currently Camunda Platform 7.14.0 and 7.15.0. The plugin is easy to try out with the official Camunda Platform Docker images, and hacking it further should not be much harder.</p>","frontmatter":{"title":"Building open source “history plugin” for Camunda Cockpit","tags":["Camunda","BPMN","Open Source"],"date":"May 03, 2021","published":"2021-05-03 12:00:00"}}},"pageContext":{"slug":"/2021/05/building-cockpit-history-plugin/","previous":{"fields":{"slug":"/2021/04/camunda-nomad-robotframework-rpa/"},"frontmatter":{"title":"My dream open source RPA orchestrator with Camunda and Nomad"}},"next":{"fields":{"slug":"/2021/07/camunda-robocorp-cloud-executor/"},"frontmatter":{"title":"Using Camunda with Robocorp Cloud for orchestrating automation"}}}},"staticQueryHashes":["63159454"],"slicesMap":{}}