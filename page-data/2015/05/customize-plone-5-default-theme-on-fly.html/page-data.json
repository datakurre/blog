{"componentChunkName":"component---src-templates-blog-post-js","path":"/2015/05/customize-plone-5-default-theme-on-fly.html/","result":{"data":{"site":{"siteMetadata":{"title":"Asko Soukka","author":"Asko Soukka"}},"markdownRemark":{"id":"f2d5f7a2-789d-5a41-aef2-1db8008c9f09","fields":{"slug":"/2015/05/customize-plone-5-default-theme-on-fly.html/"},"excerpt":"When I recently wrote about, how to reintroduce ploneCustom for\nPlone5\nTTW (through the web) by yourself, I got some feedback that it was the\nwrong thing to do…","html":"<p>When I recently wrote about, how to reintroduce <a href=\"http://datakurre.pandala.org/2015/05/plonecustom-for-plone-5.html\">ploneCustom for\nPlone5</a>\nTTW (through the web) by yourself, I got some feedback that <em>it was the\nwrong thing to do</em>. And the correct way would always be to create your\ncustom theme.</p>\n<p>If you are ready to let the precious <em>ploneCustom</em> go, here’s how to\ncurrently customize the default Barceloneta theme on the fly by creating\na new custom theme.</p>\n<h2>Inherit a new theme from Barceloneta</h2>\n<p>So, let’s customize a brand new Plone 5 site by creating a new theme,\nwhich inherits everything from Barceloneta theme, yet allows us to add\nadditional rules and styles:</p>\n<ol>\n<li>\n<p>Open <strong>Site Setup</strong> and <strong>Theming</strong> control panel.</p>\n</li>\n<li>\n<p>Create <strong>New theme</strong>, not yet activated, with title <em>mytheme</em> (or\nyour own title, once you get the concept)</p>\n</li>\n<li>\n<p>In the opened theme editor, replace the contents of <em>rules.xml</em> with\nthe following code:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\">\n      <pre class=\" cm-s-solarized\"><code><span class=\"cm-meta\">&lt;?xml</span><span> </span><span class=\"cm-meta\">version=\"1.0\" encoding=\"UTF-8\"?&gt;</span><span>\n</span><span class=\"cm-tag bracket\">&lt;</span><span class=\"cm-tag\">rules</span><span>\n</span><span>    </span><span class=\"cm-attribute\">xmlns</span><span>=</span><span class=\"cm-string\">\"http://namespaces.plone.org/diazo\"</span><span>\n</span><span>    </span><span class=\"cm-attribute\">xmlns:css</span><span>=</span><span class=\"cm-string\">\"http://namespaces.plone.org/diazo/css\"</span><span>\n</span><span>    </span><span class=\"cm-attribute\">xmlns:xsl</span><span>=</span><span class=\"cm-string\">\"http://www.w3.org/1999/XSL/Transform\"</span><span>\n</span><span>    </span><span class=\"cm-attribute\">xmlns:xi</span><span>=</span><span class=\"cm-string\">\"http://www.w3.org/2001/XInclude\"</span><span class=\"cm-tag bracket\">&gt;</span><span>\n\n</span><span>  </span><span class=\"cm-comment\">&lt;!-- Import Barceloneta rules --&gt;</span><span>\n</span><span>  </span><span class=\"cm-tag bracket\">&lt;</span><span class=\"cm-tag\">xi:include</span><span> </span><span class=\"cm-attribute\">href</span><span>=</span><span class=\"cm-string\">\"++theme++barceloneta/rules.xml\"</span><span> </span><span class=\"cm-tag bracket\">/&gt;</span><span>\n\n</span><span>  </span><span class=\"cm-tag bracket\">&lt;</span><span class=\"cm-tag\">rules</span><span> </span><span class=\"cm-attribute\">css:if-content</span><span>=</span><span class=\"cm-string\">\"#visual-portal-wrapper\"</span><span class=\"cm-tag bracket\">&gt;</span><span>\n</span><span>    </span><span class=\"cm-comment\">&lt;!-- Placeholder for your own additional rules --&gt;</span><span>\n</span><span>  </span><span class=\"cm-tag bracket\">&lt;/</span><span class=\"cm-tag\">rules</span><span class=\"cm-tag bracket\">&gt;</span><span>\n\n</span><span class=\"cm-tag bracket\">&lt;/</span><span class=\"cm-tag\">rules</span><span class=\"cm-tag bracket\">&gt;</span></code></pre>\n    </div>\n</li>\n<li>\n<p>Still in the theme editor, add <strong>New file</strong> with name <em>styles.less</em>\nand edit and <strong>Save</strong> it with the following content:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\">\n      <pre class=\" cm-s-solarized\"><code><span class=\"cm-comment\">/* Import Barceloneta styles */</span><span>\n</span><span class=\"cm-def\">@import</span><span> </span><span class=\"cm-string\">\"++theme++barceloneta/less/barceloneta.plone.less\"</span><span>;</span><span>\n\n</span><span class=\"cm-comment\">/* Customize navbar color */</span><span>\n</span><span class=\"cm-def\">@plone-sitenav-bg</span><span>: </span><span class=\"cm-tag\">pink</span><span>;</span><span>\n</span><span class=\"cm-def\">@plone-sitenav-link-hover-bg</span><span>: </span><span class=\"cm-variable callee\">darken</span><span>(</span><span class=\"cm-tag\">pink</span><span>, </span><span class=\"cm-number\">20%</span><span>);</span><span>\n\n</span><span class=\"cm-comment\">/* Customize navbar text color */</span><span>\n</span><span class=\"cm-qualifier\">.plone-nav</span><span> &gt; </span><span class=\"cm-tag\">li</span><span> &gt; </span><span class=\"cm-tag\">a</span><span> {</span><span>\n</span><span>  </span><span class=\"cm-property\">color</span><span>: </span><span class=\"cm-def\">@plone-text-color</span><span>;</span><span>\n</span><span>}</span><span>\n\n</span><span class=\"cm-comment\">/* Customize search button */</span><span>\n</span><span class=\"cm-builtin\">#searchGadget_form</span><span> </span><span class=\"cm-qualifier\">.searchButton</span><span> {</span><span>\n</span><span>  </span><span class=\"cm-comment\">/* Re-use mixin from Barceloneta */</span><span>\n</span><span>  </span><span class=\"cm-error\">.button-variant</span><span>(</span><span class=\"cm-def\">@plone-text-color</span><span>, </span><span class=\"cm-tag\">pink</span><span>, </span><span class=\"cm-def\">@plone-gray-lighter</span><span>);</span><span>\n</span><span>}</span><span>\n\n</span><span class=\"cm-comment\">/* Inspect Barceloneta theme (and its less-folder) for more... */</span></code></pre>\n    </div>\n</li>\n</ol>\n<p>But before activating the new theme, there’s one more manual step to\ndo…</p>\n<h2>Register and build a new LESS bundle</h2>\n<p>We just created a new LESS file, which would import the main Barceloneta\nLESS file at first, and then add our own additional styles with using\nsome features from LESS syntax. To actually make that LESS file into a\nusable CSS (through the browser), we need register a new bundle for it,\nand build it:</p>\n<ol>\n<li>\n<p>Open <strong>Site Setup</strong> and <strong>Resource Registries</strong> control panel.</p>\n</li>\n<li>\n<p><strong>Add resource</strong> with name <em>mytheme</em> and a single CSS/LESS file with\npath <em>++theme++mytheme/styles.less</em> to locate the file we just added\ninto our theme:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/60af432c57713495e9bbdfe78bf6e379/91e7e/resource.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAACJElEQVQ4y1VTy3KbMBTl/3+k2+6666YTEtdJm7RJZtppZ1wwMQgw6AV6INQjyXbdM4wAjc7j3gtZNXBChZpnzpkxmkdM0zSOI2NMa22txXPXdZTSYzdUXfn+57uC7CY+ZZzxYz80pPtT7Lt+KIp9XRM5zW3b9n1vIqSUUJThJltKPu4+NGOtZp3xsTz2v4SoBC3ZsJNsP8vKqs5YA1tEAHmJsGf41eMV+9nQV7T64SVZHfcLXxe2LnRd4MTKskRgpZQQAqs+Q+nTczYqU+Y5+/bkvV8BrPGCJ5LDAYegBB/nnL1CIA+vz9Vdrp2L1H+YQwsDBypDBFKkFoCW1myo9sVdPlTVyfmKDMAZZBaB8OYKgUxntctv2octorplcRHgoEi4ocGQOEZgVBfaqWYqRLG5bR6/hFKdS7bgg0wIQVSUB0+UQCPwCjnoxm4z/vvm0/H1JcX2EaBDGK9pJPoKyRy1QC7DEN62G/ryfB0bgDzqhI/5H4mPXKgom/ib4KUxnZnJ+WqMbpUKZEjApI9AVAwPJaRvJsSeBOG0tZovRqQLz2buQWuapq5rnIYKqk0952eEhgmObMqvdnV2XTQKZg93dJsbt05SQh5kGF5oF6FIFqJpiBDSh5pdJG/Z/UYvrmvb1Nv0V2DFYeyk2IGMrTrgALEwKu/p/Wb8fItvro1ItOSZ0l6aF8iHwwFJ4mAsyPz7I3v6ik8Zm+nHSJNP6+UPQ6K/yC7LqckXGPYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/60af432c57713495e9bbdfe78bf6e379/fcda8/resource.png\"\n        srcset=\"/static/60af432c57713495e9bbdfe78bf6e379/12f09/resource.png 148w,\n/static/60af432c57713495e9bbdfe78bf6e379/e4a3f/resource.png 295w,\n/static/60af432c57713495e9bbdfe78bf6e379/fcda8/resource.png 590w,\n/static/60af432c57713495e9bbdfe78bf6e379/91e7e/resource.png 692w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n</li>\n<li>\n<p><strong>Save</strong>.</p>\n</li>\n<li>\n<p><strong>Add bundle</strong> with name <em>mytheme</em>, requiring <em>mytheme</em> resoure,\nwhich we just created and <em>Does your bundle contain any RequireJS or\nLESS files?</em> checked:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f29c24077238a5e84f06ca9c8e446416/0f79a/bundle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.8918918918919%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsSAAALEgHS3X78AAACnElEQVQ4y2VTy27TQBT11yEW/Qj4A6QiwZIFCNEP6AapQkIqLIFVF6VtBE1bUhChoABpE5racWyPH+N52mM7HI+pCOJ0NLkd+cw59zFOmOUxZUBEiFIqiqI4ThjnQRAQQoqiMMYkSbJYLNI0DYPQJ/O3v3bceCa5dBilcRSGQeB5XhhG8/mckFgpzVguhACzLMviL0qppU89rrgpjZOQ6Twcc7kopCv5TEuvkF6pA63BZ3med+LlCpqqAROBc3erd+fB09sPX9/c6K092Vvb2L/xaPfWZj+juee6nHPcAgsr4oXGn4WztTt683Jn89n++ovRve2z+9tf15+fPX71Q0iFtCEO8tXVFWLzL3Du5FqTT4Pi52gJNM1y2f02EKA0hzKqOLegFlmWYUc6OHeSyeSy/57TvGqWpalMVWMh6IxBAZ59iziOwaHXsOTRN//jADnVVVWvAK6gJixmsxmzAEFb4BD/OpnWF7396HTQuq3rxqIjo88wCUJ2DXipqgp2sLfVppxdHh0Gw8/Nf2TMBq6XUiJAph3fxhkGBuVwMsam/XcwD+V6hYyLu9pxIeMk5YzBqrwG4rbaVKjpwUH6ZWjJIC7tarqcSRRJbQKSCcFRktVWtbaVICKeFmxRFmmpk3YpUuoU5PPzc7RXa9W6TFMYRsGxQxnkdkgk82jqgmmKrF06rSqMdIo+d1UQqvTDpOOjQ4kF0m5zFoLilqZBAdEtEBr+/YyNhtoYvBeUGjlfXEzwbFzXxaihBdyiVUY9cRNMtjlXFXb64Yge94u6xudhGGIwJhgki/F43J1AGc4dRJge5IbL2laBfHpCB8cgL3y/axU0UTzXAgE+xmFbMJDtGya4CeQ/yieHyhhYVbYxCPBNt0PJvvwQZn8Df5TrE8br+7sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/f29c24077238a5e84f06ca9c8e446416/fcda8/bundle.png\"\n        srcset=\"/static/f29c24077238a5e84f06ca9c8e446416/12f09/bundle.png 148w,\n/static/f29c24077238a5e84f06ca9c8e446416/e4a3f/bundle.png 295w,\n/static/f29c24077238a5e84f06ca9c8e446416/fcda8/bundle.png 590w,\n/static/f29c24077238a5e84f06ca9c8e446416/0f79a/bundle.png 689w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n</li>\n<li>\n<p><strong>Save</strong>.</p>\n</li>\n<li>\n<p><strong>Build</strong> <em>mytheme</em> bundle.</p>\n</li>\n</ol>\n<p>Now you should be ready to return back to <strong>Theming</strong> control panel,\nactivate the theme, and see the gorgeous pink navigation bar:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/495856a0228e4b0c100cbcdc6280990d/37523/result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.37837837837837%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAACLElEQVQoz4WQz2/SYBzG+xd4N/7YVIZBJOL07sl/wZv3nUy8efZv8ODFaOLFxMPiddlohRXoSgttKW3ftsAKjB8Cg0KhtBT80sqcB+GTp0+ePm+et0mx3du37kSe7L39+PzFy4ev3tx4d/goGn22/zQW3795PxyNREKhvXA4HI/HH8diEO7u7twLPdjxwYocxxSEQ1pLnPEpHmVRnSlwoiCIQpHneT8IAsfxhUKRF0RRzGcp5oQQ8nkoseVyOXC8b5VxojEhGtaRMVKGLpSLxfIKZ+72zOHQsmxv7l6aU626cOfQY556Pudk+8sP7yRjK7otqlNRtUVtVtI9pRJoLpVngjoVFFtAHjpflutBjw0yzOAoZb7/0P38vYGn2zjZTJCtRLpDZIZkbnBKB4JsksyQZAanuUHqT4nJSJFVpBhVVClruq7qmu860tTV0VrStXwlTJVlpVSiyDSdpVia5liWpXMFhoGAJAlONwhTFQX+ZxJP4MfHBI4nCQL0kyDOKArJ8mb546KYJKl0NsfkGA0hXVXBQdvHFSSn2dLrT7mDr0yGLepIVrZt/o7hkSWJ5aU8LymShOSVB9o+rhsG6KJmNGpGuQpeu6jXwYN+szDHcSaTSafT6QH9S6DX7fb7fShd13V8Zv9hNbZtu91u99bAEnxkmnA89Zk5/wB9EDC4Ho7bPvD9X2uazWar1QKHbFnWZE2Qgz0W3GT6jEajKw8Yj8e2z/Qa8BqMfwOcTiCt7YfgVQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/495856a0228e4b0c100cbcdc6280990d/fcda8/result.png\"\n        srcset=\"/static/495856a0228e4b0c100cbcdc6280990d/12f09/result.png 148w,\n/static/495856a0228e4b0c100cbcdc6280990d/e4a3f/result.png 295w,\n/static/495856a0228e4b0c100cbcdc6280990d/fcda8/result.png 590w,\n/static/495856a0228e4b0c100cbcdc6280990d/37523/result.png 720w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><strong>Note:</strong> To really be a good citizen and follow the rules, there’s a\nfew additional steps:</p>\n<ol>\n<li>\n<p>Add <em>production-css</em> setting into your theme’s <em>manifest.cfg</em> to\npoint to the compiled CSS bundle:</p>\n<div class=\"gatsby-highlight\" data-language=\"properties\">\n      <pre class=\" cm-s-solarized\"><code><span class=\"cm-header\">[theme]</span><span>\n</span><span class=\"cm-def\">title </span><span>=</span><span class=\"cm-quote\"> mytheme</span><span>\n</span><span class=\"cm-def\">description </span><span>=</span><span class=\"cm-quote\"> </span><span>\n</span><span class=\"cm-def\">production-css </span><span>=</span><span class=\"cm-quote\"> /++plone++static/mytheme-compiled.css</span></code></pre>\n    </div>\n</li>\n<li>\n<p>In Resource Registries, disable <em>mytheme</em> bundle by unchecking its\n<em>Enabled</em> checkbox and clicking <em>Save</em>.</p>\n</li>\n<li>\n<p>Deactivate and activate the theme once.</p>\n</li>\n</ol>\n<p>Technically this changes the CSS bundle to be registered as a so called\n<em>Diazo bundle</em> instead of a regular bundle. The difference is that Diazo\nbundle is always rendered last and can therefore override any CSS rule\nintroduced the other enabled bundles. Also, as a Diazo bundle it get\ndisabled and enabled properly when the active gets changed.</p>","frontmatter":{"title":"Customize Plone 5 default theme on the fly","tags":["Plone","TTW"],"date":"May 25, 2015","published":"2015-05-25 06:00:00"}}},"pageContext":{"slug":"/2015/05/customize-plone-5-default-theme-on-fly.html/","previous":{"fields":{"slug":"/2015/05/plonecustom-for-plone-5.html/"},"frontmatter":{"title":"ploneCustom for Plone 5"}},"next":{"fields":{"slug":"/2015/07/stateless-nix-environments-revisited.html/"},"frontmatter":{"title":"Stateless Nix environments revisited"}}}},"staticQueryHashes":["63159454"],"slicesMap":{}}